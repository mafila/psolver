{
	static int el[12][2]= {{17,13},{23,36},{30,82},{24,75}, {7,34},{45,87},{84,78},{65,4}, {2,49},{55,68},{61,94},{52,39}};
	static int cl[8][3]= {{12,16,67 },{15,32,19 },{3,48,35 },{0,64,51 },{83,31,44 },{95,47,60 },{92,63,76 },{80,79,28}};

	int w= (a[17]==a[18]&&a[13]==a[14])+(a[23]==a[27]&&a[36]==a[40])+(a[30]==a[29]&&a[82]==a[81])+(a[24]==a[20]&&a[75]==a[71])
		+(a[49]==a[50]&&a[1]==a[2])+(a[55]==a[59]&&a[68]==a[72])+(a[61]==a[62]&&a[93]==a[94])+(a[52]==a[56]&&a[39]==a[43])
		+(a[7]==a[11]&&a[33]==a[34])+(a[87]==a[91]&&a[45]==a[46])+(a[77]==a[78]&&a[84]==a[88])+(a[4]==a[8]&&a[65]==a[66]);
		
	if (w==12) {
		char ec[12][2], cc[8][3];
		int ep[12], cp[8], ecnt= 0, epo= 0, epa= 0, ccnt= 0, cpo= 0, cpa= 0, i, j, slv=0;
		for(int i=0; i<12; i++) for(int j=0; j<2; j++) ec[i][j]= a[ (el[i][j]&0xF0)+5 ];
		for(int i=0; i<8; i++) for(int j=0; j<3; j++) cc[i][j]= a[ (cl[i][j]&0xF0)+5 ];
		for(i=0; i<12; i++) {
			for(j=0; j<12; j++) {
				if (a[ el[j][0] ]==ec[i][0] && a[ el[j][1] ]==ec[i][1]) break;
				if (a[ el[j][0] ]==ec[i][1] && a[ el[j][1] ]==ec[i][0]) { epo++; break; }
			}
			if (j<12) { ecnt++; ep[i]= j; }
		}
		if (ecnt==12 && epo%2==0) {
			for(i=0; i<8; i++) {
				for(j=0; j<8; j++) {
					if (a[ cl[j][0] ]==cc[i][0] && a[ cl[j][1] ]==cc[i][1] && a[ cl[j][2] ]==cc[i][2]) break;
					if (a[ cl[j][0] ]==cc[i][1] && a[ cl[j][1] ]==cc[i][2] && a[ cl[j][2] ]==cc[i][0]) { cpo++; break; }
					if (a[ cl[j][0] ]==cc[i][2] && a[ cl[j][1] ]==cc[i][0] && a[ cl[j][2] ]==cc[i][1]) { cpo+=2; break; }
				}
				if (j<8) { ccnt++; cp[i]= j; }
			}
			if (ccnt==8 && cpo%3==0) {
				for(i=11; i>=1; i--) for (j=i-1; j>=0; j--) if (ep[j]>ep[i]) epa++; 
				for(i=7; i>=1; i--) for (j=i-1; j>=0; j--) if (cp[j]>cp[i]) cpa++; 
				slv= (epa%2)==(cpa%2);
			}
		}
		return w+slv;
	}
	return w;
}
